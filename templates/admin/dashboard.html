{% extends "admin/base_site.html" %}
{% load static %}

{% block content %}
<div id="content-main">
    <div class="dashboard-nav">
        <div class="row">
            <div class="col-md-3">
                <a href="{% url 'admin:blog_post_changelist' %}" class="nav-link d-block">
                    <i class="fas fa-newspaper me-2"></i> 文章管理
                </a>
            </div>
            <div class="col-md-3">
                <a href="{% url 'admin:blog_category_changelist' %}" class="nav-link d-block">
                    <i class="fas fa-tags me-2"></i> 分类管理
                </a>
            </div>
            <div class="col-md-3">
                <a href="{% url 'admin:blog_comment_changelist' %}" class="nav-link d-block">
                    <i class="fas fa-comments me-2"></i> 评论管理
                </a>
            </div>
            <div class="col-md-3">
                <a href="{% url 'admin:auth_user_changelist' %}" class="nav-link d-block">
                    <i class="fas fa-users me-2"></i> 用户管理
                </a>
            </div>
        </div>
    </div>

    <!-- 统计卡片 -->
    <div class="dashboard-stats">
        <div class="stat-card primary">
            <i class="fas fa-newspaper fa-3x mb-3"></i>
            <h3>{{ stats.total_posts }}</h3>
            <p>总文章数</p>
        </div>
        
        <div class="stat-card success">
            <i class="fas fa-check-circle fa-3x mb-3"></i>
            <h3>{{ stats.published_posts }}</h3>
            <p>已发布</p>
        </div>
        
        <div class="stat-card warning">
            <i class="fas fa-edit fa-3x mb-3"></i>
            <h3>{{ stats.draft_posts }}</h3>
            <p>草稿</p>
        </div>
        
        <div class="stat-card info">
            <i class="fas fa-tags fa-3x mb-3"></i>
            <h3>{{ stats.total_categories }}</h3>
            <p>分类数</p>
        </div>
        
        <div class="stat-card primary">
            <i class="fas fa-comments fa-3x mb-3"></i>
            <h3>{{ stats.total_comments }}</h3>
            <p>总评论数</p>
        </div>
        
        <div class="stat-card danger">
            <i class="fas fa-clock fa-3x mb-3"></i>
            <h3>{{ stats.pending_comments }}</h3>
            <p>待审核评论</p>
        </div>
    </div>

    <!-- 最新活动 -->
    <div class="row mt-4">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-newspaper me-2"></i> 最新文章
                    </h5>
                </div>
                <div class="card-body">
                    {% if latest_posts %}
                        {% for post in latest_posts %}
                            <div class="recent-item">
                                <div class="d-flex justify-content-between align-items-center">
                                    <h6 class="mb-1">
                                        <a href="/admin/blog/blog/post/{{ post.id }}/change/" 
                                           class="text-decoration-none">
                                            {{ post.title }}
                                        </a>
                                    </h6>
                                    <span class="badge bg-{{ 'success' if post.status == 'published' else 'warning' }}">
                                        {{ post.get_status_display }}
                                    </span>
                                </div>
                                <small class="text-muted">
                                    <i class="fas fa-user me-1"></i>{{ post.author.username }}
                                    <i class="fas fa-calendar ms-2 me-1"></i>{{ post.created_at|date:"m月d日" }}
                                </small>
                            </div>
                        {% endfor %}
                    {% else %}
                        <p class="text-muted">暂无文章</p>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-comments me-2"></i> 最新评论
                    </h5>
                </div>
                <div class="card-body">
                    {% if latest_comments %}
                        {% for comment in latest_comments %}
                            <div class="recent-item">
                                <div class="d-flex justify-content-between align-items-center">
                                    <h6 class="mb-1">
                                        <a href="/admin/blog/blog/comment/{{ comment.id }}/change/" 
                                           class="text-decoration-none">
                                            评论 "{{ comment.post.title|truncatechars:30 }}"
                                        </a>
                                    </h6>
                                    <span class="badge bg-{{ 'success' if comment.is_approved else 'warning' }}">
                                        {{ '已审核' if comment.is_approved else '待审核' }}
                                    </span>
                                </div>
                                <small class="text-muted">
                                    <i class="fas fa-user me-1"></i>{{ comment.author.username }}
                                    <i class="fas fa-calendar ms-2 me-1"></i>{{ comment.created_at|date:"m月d日 H:i" }}
                                </small>
                                <p class="mb-0 mt-2">{{ comment.content|truncatechars:50 }}</p>
                            </div>
                        {% endfor %}
                    {% else %}
                        <p class="text-muted">暂无评论</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    
    <!-- 快捷操作 -->
    <div class="text-center mt-4">
        <a href="{% url 'admin:blog_post_add' %}" class="btn btn-custom btn-lg me-3">
            <i class="fas fa-plus me-2"></i> 写新文章
        </a>
        <a href="{% url 'blog:blog_category_add' %}" class="btn btn-custom btn-lg me-3">
            <i class="fas fa-plus me-2"></i> 添加分类
        </a>
        <a href="{% url 'blog:home' %}" class="btn btn-outline-primary btn-lg">
            <i class="fas fa-home me-2"></i> 返回前台
        </a>
    </div>
</div>
{% endblock %}
